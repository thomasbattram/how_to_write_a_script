---
title: "Gwen’s and Tom’s simple guide to writing a script"
author: "Gwen Fernandes, Thomas Battram"
output: 
  powerpoint_presentation:
    reference_doc: ../slides/uob_template_for_markdown.pptx
---

### Outline

* Commenting your scripts
* What to think about before starting to script
* How the top of your script should look
* Making your code easier to read
* Saving your scripts

### Commenting

* Code with a # before it does not get run
* This is useful for making your scripts much easier to read! 
* Comment on WHY and WHAT (to start with)
	+ Start with many comments!!!
Also, use comments to split up the script to make it clearer e.g.

``` {r commenting, echo = TRUE, eval = FALSE}
# ------------------------------------------
# Part A of script
# ------------------------------------------

# comment
some_code

# comment
more_code

# ------------------------------------------
# Part B of script
# ------------------------------------------

```


### 3 steps before starting
1. Why am I writing this script?
2. What do I need to write this script?
3. How am I going to write this script? 

### Step 1: Why am I writing this script? 

* Think about it and write it down!!!
* e.g. clean a dataset, assess association between x and y

* Give the script a good name, write a descriptive title + add a couple of lines that describe the purpose of the script

``` {r title example, echo = TRUE}
# ------------------------------------------
# Generating pack years in ALSPAC
# ------------------------------------------

# This script extracts smoking variables from the mothers within ALSPAC and uses this to generate pack years. Authors: Thomas Battram, Gwen Fernandes. Date: 2020/02/15
```

### Step 2: What do I need to write this script?

* Datasets!

* Using only base R can make things difficult... Packages! 
* Packages are made by others and are there to make your life easier

<br>

For example, reading data into R can be tricky depending on how the data is stored, but packages can make this easier! 

### Reading data into R

Depending on what form the data is in, you have to use different functions to read in the data. Data you get may be in:

* excel spreadsheets
* comma seperated value (csv) files 
* text separated value (tsv) files
* spss files
* stata files
* images (e.g. .png files)

These need different functions to read them in, some of which are only available with certain packages.

``` {r package example, echo = TRUE, eval = FALSE}
library(haven)
df <- read_dta("my_data.dta")
```


### Step 3: How am I going to write this script? 

* As you have thought about why you're writing the script and what you need this should be easy! 
* Write out each step

``` {r instructions example, echo = TRUE}

# structure of the script:
# 1. Extract the smoking variables
# 2. Exclude indiviauls with withdrawn consent and too much missing data
# 3. Generate pack years variable 
# 4. Check for outliers
# 5. Write out a table with identifiers and pack years variables

```

### Top of the script
``` {r top of script, echo = TRUE, eval = FALSE}
# ------------------------------------------
# Generating pack years in ALSPAC
# ------------------------------------------

# This script extracts smoking variables from the mothers within ALSPAC and uses this to generate pack years. Authors: Thomas Battram, Gwen Fernandes. Date: 2020/02/15

# load packages
library(haven)

# read in data
df <- read_dta("my_data.dta")

# structure of the script:
# 1. Extract the smoking variables
# 2. Exclude individuals with withdrawn consent and too much missing data
# 3. Generate pack years variable 
# 4. Check for outliers
# 5. Write out a table with identifiers and pack years variables

```

### Make your code easy to read

2 big points here:

1. Use a consistent style when writing code

``` {r consistent_style, echo = TRUE, eval = FALSE}
a_var <- c(1, 2, 3)
a.var <- c(1, 2, 3)
aVar <- c(1, 2, 3)
```

<br>

2. Use spaces appropriately

``` {r spaces, echo = TRUE, eval = FALSE}
x <-c(1,2,51,124,60386920-142,4124)
x <- c(1, 2, 51, 124, 60386920 - 142, 4124)
x   <-        c(1   ,2    ,   51,124    ,60386920-     142, 4124) 
```

### Saving scripts

It's important to save scripts as you go and you can always come back to them and send them to other people.

To save the script you can just press the save button in RStudio or press ctrl + S (or cmd + S for Macs).

Give the script a good name and save it regularly! 

### Summary 

3 questions to think about before writing a script:

1. Why am I writing this script?
2. What do I need to write this script?
3. How am I going to write this script? 

<br>

* Comment your code a lot
* Make your code easy to read
* Save your scripts regularly

--- 

Slides and markdown script is available here: https://github.com/thomasbattram/how_to_write_a_script

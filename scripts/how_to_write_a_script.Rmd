---
title: "Gwen’s and Tom’s simple guide to writing a script"
author: "Gwen Fernandes, Thomas Battram"
output: 
  powerpoint_presentation:
    reference_doc: ../slides/uob_template_for_markdown.pptx
---

### 3 steps before starting
1. Why am I writing this script?
2. What do I need to write this script?
3. How am I going to write this script? 

### Step 1: Why am I writing this script? 

* Think about it and write it down!!!
* e.g. clean a dataset, assess association between x and y

* Give the script a good name, write a descriptive title + add a couple of lines that describe the purpose of the script

``` {r title example, echo = TRUE}
# ------------------------------------------
# Generating pack years in ALSPAC
# ------------------------------------------

# This script extracts smoking variables from the mothers within ALSPAC and uses this to generate pack years. Authors: Thomas Battram, Gwen Fernandes. Date: 2020/02/15
```

### Step 2: What do I need to write this script?

* Datasets!

* Using only base R can make things difficult... Packages! 

<br>

For example, you can use packages to read data in a Stata format directly into R

<br>

``` {r package example, echo = TRUE, eval = FALSE}
library(haven)
df <- read_dta("my_data.dta")
```


### Step 3: How am I going to write this script? 

* As you have thought about why you're writing the script and what you need this should be easy! 
* Write out each step

``` {r instructions example, echo = TRUE}

# 1. Extract the smoking variables
# 2. Exclude indiviauls with withdrawn consent and too much missing data
# 3. Generate pack years variable 
# 4. Check for outliers
# 5. Write out a table with identifiers and pack years variables

```

### Top of the script
``` {r top of script, echo = TRUE, eval = FALSE}
# ------------------------------------------
# Generating pack years in ALSPAC
# ------------------------------------------

# This script extracts smoking variables from the mothers within ALSPAC and uses this to generate pack years. Authors: Thomas Battram, Gwen Fernandes. Date: 2020/02/15

# load packages
library(haven)

# read in data
df <- read_dta("my_data.dta")

# structure of the script:
# 1. Extract the smoking variables
# 2. Exclude individuals with withdrawn consent and too much missing data
# 3. Generate pack years variable 
# 4. Check for outliers
# 5. Write out a table with identifiers and pack years variables

```

### Commenting

* Start with many comments! 
* As you code more you'll end up wanting to comment just to explain WHY things are being done, but to begin with I found it easier to comment WHAT was happening as well as why things are being done.

* Also, use comments to split up the script to make it clearer e.g.

``` {r commenting, echo = TRUE, eval = FALSE}
# ------------------------------------------
# Extracting smoking variables and excluding individuals
# ------------------------------------------

# comment
some_code

# comment
more_code

# ------------------------------------------
# Generating pack years
# ------------------------------------------

```

### Make your code easy to read

2 big points here:

1. Use a consistent style when writing code

``` {r consistent_style, echo = TRUE, eval = FALSE}
a_var <- c(1, 2, 3)
a.var <- c(1, 2, 3)
aVar <- c(1, 2, 3)
```

<br>

2. Use spaces appropriately

``` {r spaces, echo = TRUE, eval = FALSE}
x <-c(1,2,51,124,60386920-142,4124)
x <- c(1, 2, 51, 124, 60386920 - 142, 4124)
x   <-        c(1   ,2    ,   51,124    ,60386920-     142, 4124) 
```

--- 

Slides and markdown script is available here: https://github.com/thomasbattram/how_to_write_a_script
